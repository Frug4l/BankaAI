<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –≤—ã–ø–∏—Å–æ–∫ - –°–¢–ê–ù–ö–ò–ù</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: Arial; background: #f5f5f5; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        header { background: #1a237e; color: white; padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 20px; }
        h1 { margin-bottom: 10px; }
        .university { color: #bbdefb; margin: 10px 0; }
        .upload-area { background: white; border: 3px dashed #1a237e; border-radius: 10px; padding: 40px; text-align: center; margin: 20px 0; cursor: pointer; }
        .upload-area:hover { border-color: #00bcd4; }
        button { background: #00bcd4; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; margin: 10px; font-size: 16px; }
        button:hover { background: #0097a7; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; background: white; }
        th, td { padding: 12px; border: 1px solid #ddd; text-align: left; }
        th { background: #1a237e; color: white; }
        .category { padding: 4px 8px; border-radius: 4px; color: white; font-size: 12px; }
        .category-–∞—Ä–µ–Ω–¥–∞ { background: #FF6384; }
        .category-–∑–∞—Ä–ø–ª–∞—Ç–∞ { background: #36A2EB; }
        .category-–Ω–∞–ª–æ–≥–∏ { background: #FFCE56; color: #333; }
        .category-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥ { background: #4BC0C0; }
        .category-–∑–∞–∫—É–ø–∫–∏ { background: #9966FF; }
        .loading { display: none; text-align: center; padding: 30px; }
        .spinner { border: 5px solid #f3f3f3; border-top: 5px solid #1a237e; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ñ AI –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –≤—ã–ø–∏—Å–æ–∫</h1>
            <div class="university">–ú–ì–¢–£ "–°–¢–ê–ù–ö–ò–ù" | –ì—Ä—É–ø–ø–∞ –ò–î–ë-24-15</div>
            <p>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ "–û—Å–Ω–æ–≤—ã —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞"</p>
        </header>

        <div class="upload-area" onclick="document.getElementById('fileInput').click()">
            <h2>üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç–µ –±–∞–Ω–∫–æ–≤—Å–∫—É—é –≤—ã–ø–∏—Å–∫—É (CSV)</h2>
            <p>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
            <p>–§–æ—Ä–º–∞—Ç: –î–∞—Ç–∞, –û–ø–∏—Å–∞–Ω–∏–µ, –°—É–º–º–∞</p>
            
            <input type="file" id="fileInput" accept=".csv" style="display: none;">
            
            <div style="margin-top: 20px;">
                <button onclick="document.getElementById('fileInput').click()">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</button>
                <button onclick="createTestFile()" style="background: #9c27b0;">–¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª</button>
                <button onclick="showDemo()" style="background: #4caf50;">–î–µ–º–æ</button>
            </div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <h3>AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ...</h3>
        </div>

        <div id="results" style="display: none;">
            <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã AI-–∞–Ω–∞–ª–∏–∑–∞</h2>
            
            <div style="background: white; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h3>
                <p>–û–±—â–∞—è —Å—É–º–º–∞: <span id="totalAmount" style="font-weight: bold; color: #1a237e;">0 ‚ÇΩ</span></p>
                <p>–û–ø–µ—Ä–∞—Ü–∏–π: <span id="transactionCount" style="font-weight: bold; color: #00bcd4;">0</span></p>
                <p>–ö–∞—Ç–µ–≥–æ—Ä–∏–π: <span id="categoryCount" style="font-weight: bold; color: #4caf50;">0</span></p>
            </div>

            <table id="dataTable">
                <thead>
                    <tr>
                        <th>–î–∞—Ç–∞</th>
                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                        <th>–°—É–º–º–∞</th>
                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è AI</th>
                        <th>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>

            <div style="text-align: center; margin: 30px 0;">
                <button onclick="exportToCSV()" style="background: #4caf50;">üì• –°–∫–∞—á–∞—Ç—å –æ—Ç—á–µ—Ç</button>
                <button onclick="window.print()" style="background: #ff9800;">üñ®Ô∏è –ü–µ—á–∞—Ç—å</button>
                <button onclick="resetAnalysis()" style="background: #f44336;">üîÑ –ù–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑</button>
            </div>
        </div>
    </div>

    <script>
        // AI —Ñ—É–Ω–∫—Ü–∏—è
        function aiCategorize(description, amount) {
            const desc = description.toLowerCase();
            if (desc.includes('–∞—Ä–µ–Ω–¥')) return ['–∞—Ä–µ–Ω–¥–∞', 0.95];
            if (desc.includes('–∑–ø') || desc.includes('–∑–∞—Ä–ø–ª–∞—Ç')) return ['–∑–∞—Ä–ø–ª–∞—Ç–∞', 0.90];
            if (desc.includes('–Ω–∞–ª–æ–≥')) return ['–Ω–∞–ª–æ–≥–∏', 0.92];
            if (desc.includes('—Ä–µ–∫–ª–∞–º') || desc.includes('—è–Ω–¥–µ–∫—Å')) return ['–º–∞—Ä–∫–µ—Ç–∏–Ω–≥', 0.88];
            if (desc.includes('–∑–∞–∫—É–ø') || desc.includes('—Ç–æ–≤–∞—Ä')) return ['–∑–∞–∫—É–ø–∫–∏', 0.85];
            if (desc.includes('—É—Å–ª—É–≥')) return ['—É—Å–ª—É–≥–∏', 0.80];
            if (desc.includes('–±–µ–Ω–∑–∏–Ω')) return ['—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç', 0.75];
            if (desc.includes('—Å–≤—è–∑')) return ['—Å–≤—è–∑—å', 0.70];
            if (amount < 0) return ['–≤–æ–∑–≤—Ä–∞—Ç', 0.85];
            return ['–ø—Ä–æ—á–∏–µ', 0.60];
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) analyzeFile(file);
        });

        // –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
        const uploadArea = document.querySelector('.upload-area');
        uploadArea.addEventListener('dragover', e => { e.preventDefault(); uploadArea.style.borderColor = '#00bcd4'; });
        uploadArea.addEventListener('dragleave', () => { uploadArea.style.borderColor = '#1a237e'; });
        uploadArea.addEventListener('drop', e => {
            e.preventDefault();
            uploadArea.style.borderColor = '#1a237e';
            if (e.dataTransfer.files[0]) analyzeFile(e.dataTransfer.files[0]);
        });

        function analyzeFile(file) {
            if (!file.name.endsWith('.csv')) {
                alert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV —Ñ–∞–π–ª');
                return;
            }

            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';

            const reader = new FileReader();
            reader.onload = e => {
                processCSVData(e.target.result);
                document.getElementById('loading').style.display = 'none';
            };
            reader.readAsText(file, 'UTF-8');
        }

        function processCSVData(csvText) {
            const lines = csvText.split('\n');
            const transactions = [];
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                const cells = line.split(',').map(cell => cell.replace(/"/g, '').trim());
                if (cells.length < 3) continue;
                
                const [date, description, amountStr] = cells;
                const amount = parseFloat(amountStr) || 0;
                const [category, confidence] = aiCategorize(description, amount);
                
                transactions.push({ date, description, amount, category, confidence });
            }
            
            displayResults(transactions);
        }

        function displayResults(transactions) {
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            const total = transactions.reduce((sum, t) => sum + t.amount, 0);
            const categories = new Set(transactions.map(t => t.category));
            
            document.getElementById('totalAmount').textContent = 
                total.toLocaleString('ru-RU') + ' ‚ÇΩ';
            document.getElementById('transactionCount').textContent = transactions.length;
            document.getElementById('categoryCount').textContent = categories.size;
            
            // –¢–∞–±–ª–∏—Ü–∞
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            transactions.forEach(t => {
                const row = document.createElement('tr');
                const amountColor = t.amount < 0 ? '#4CAF50' : (t.amount > 100000 ? '#f44336' : '#333');
                
                row.innerHTML = `
                    <td>${t.date || ''}</td>
                    <td>${t.description || ''}</td>
                    <td style="color: ${amountColor}; font-weight: bold;">
                        ${t.amount.toLocaleString('ru-RU')} ‚ÇΩ
                    </td>
                    <td><span class="category category-${t.category}">${t.category}</span></td>
                    <td>${(t.confidence * 100).toFixed(1)}%</td>
                `;
                tableBody.appendChild(row);
            });
            
            document.getElementById('results').style.display = 'block';
            window.transactionsData = transactions;
        }

        function createTestFile() {
            const testCSV = `–î–∞—Ç–∞,–û–ø–∏—Å–∞–Ω–∏–µ,–°—É–º–º–∞
2024-01-15,–ê—Ä–µ–Ω–¥–∞ –æ—Ñ–∏—Å–∞,50000
2024-01-16,–ó–∞—Ä–ø–ª–∞—Ç–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤,150000
2024-01-17,–ù–∞–ª–æ–≥ –£–°–ù,25000
2024-01-18,–†–µ–∫–ª–∞–º–∞ –Ø–Ω–¥–µ–∫—Å,30000
2024-01-19,–ó–∞–∫—É–ø–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤,80000`;
            
            const blob = new Blob(['\uFEFF' + testCSV], { type: 'text/csv;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = '—Ç–µ—Å—Ç–æ–≤–∞—è_–≤—ã–ø–∏—Å–∫–∞.csv';
            a.click();
        }

        function showDemo() {
            const demoData = [
                { date: '2024-01-15', description: '–ê–†–ï–ù–î–ê –û–§–ò–°–ê', amount: 50000, category: '–∞—Ä–µ–Ω–¥–∞', confidence: 0.95 },
                { date: '2024-01-16', description: '–ó–ê–†–ü–õ–ê–¢–ê', amount: 150000, category: '–∑–∞—Ä–ø–ª–∞—Ç–∞', confidence: 0.90 },
                { date: '2024-01-17', description: '–ù–ê–õ–û–ì –£–°–ù', amount: 25000, category: '–Ω–∞–ª–æ–≥–∏', confidence: 0.92 },
                { date: '2024-01-18', description: '–†–ï–ö–õ–ê–ú–ê –Ø–ù–î–ï–ö–°', amount: 30000, category: '–º–∞—Ä–∫–µ—Ç–∏–Ω–≥', confidence: 0.88 },
                { date: '2024-01-19', description: '–ó–ê–ö–£–ü–ö–ê –¢–û–í–ê–†–ê', amount: 80000, category: '–∑–∞–∫—É–ø–∫–∏', confidence: 0.85 }
            ];
            displayResults(demoData);
        }

        function exportToCSV() {
            if (!window.transactionsData) return alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö');
            
            const headers = ['–î–∞—Ç–∞', '–û–ø–∏—Å–∞–Ω–∏–µ', '–°—É–º–º–∞', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è AI', '–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å%'];
            const rows = window.transactionsData.map(t => [t.date, t.description, t.amount, t.category, (t.confidence * 100).toFixed(1)]);
            const csvContent = [headers.join(','), ...rows.map(row => row.join(','))].join('\n');
            
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ai_–∞–Ω–∞–ª–∏–∑.csv';
            a.click();
        }

        function resetAnalysis() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('fileInput').value = '';
        }
    </script>
</body>
</html>
